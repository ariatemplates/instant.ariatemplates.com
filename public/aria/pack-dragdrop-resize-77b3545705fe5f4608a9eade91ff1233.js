/*
 * Aria Templates 1.4.4 - 22 May 2013
 *
 * Copyright 2009-2013 Amadeus s.a.s.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
//***MULTI-PART
//*******************
//LOGICAL-PATH:aria/utils/dragdrop/IDrag.js
//*******************
Aria.interfaceDefinition({$classpath:"aria.utils.dragdrop.IDrag",$interface:{start:{$type:"Function"},move:{$type:"Function"},end:{$type:"Function"}},$events:{dragstart:"",move:"",dragend:"",beforeresize:"",resize:"",resizeend:""}});
//*******************
//LOGICAL-PATH:aria/utils/dragdrop/Drag.js
//*******************
(function(){function e(e,t,i){e&&e.setAttribute(t,i)}function t(e,t){e&&e.removeAttribute(t)}var i=0;Aria.classDefinition({$classpath:"aria.utils.dragdrop.Drag",$dependencies:["aria.utils.Dom","aria.utils.Mouse","aria.utils.Type"],$implements:["aria.utils.dragdrop.IDrag"],$statics:{INVALID_ATTRIBUTE:"Invalid attribute '%1' in '%2'"},$constructor:function(t,i){i=i||{},this.id=null,this.element=null;var r=aria.utils.Type;r.isString(t)?this.id=t:r.isHTMLElement(t)?(this.element=t,this.id=this.element.id):(this.$logError(this.INVALID_ATTRIBUTE,["id","constructor"]),this.start=Aria.empty,this.move=Aria.empty,this.end=Aria.empty),this.params=i,this.handle=i.handle,this.cursor=i.cursor,this.originalCursor=null,this.proxy=null,this.posX=null,this.posY=null,this._boundary=null,this._horizontal=i.axis&&"x"==i.axis,this._vertical=i.axis&&"y"==i.axis,this._elementInitialPosition=null,this._movableInitialGeometry=null,this._movableGeometry=null,this._baseMovableOffset=null,this.listenerId=aria.utils.Mouse.listen("drag",this),e(this.getDraggable(!0),aria.utils.Mouse.DRAGGABLE_ATTRIBUTE,this.listenerId),this.getMovable(!1)},$destructor:function(){var e=this.getDraggable();e&&(t(e,aria.utils.Mouse.DRAGGABLE_ATTRIBUTE),e.style.cursor=this.originalCursor,e=null),this.proxy&&this.proxy.overlay&&this.proxy.$dispose(),this.element=null,this.handle=null,this.cursor=null,this.proxy=null,aria.utils.Mouse.stopListen("drag",this)},$prototype:{getDraggable:function(e){var t,i=this.handle,r=this.cursor;if(i){var s=aria.utils.Type;s.isString(i)&&(i=aria.utils.Dom.getElementById(i)),s.isHTMLElement(i)?(this.handle=i,t=i):e===!0&&this.$logError(this.INVALID_ATTRIBUTE,["handle","params"])}else t=this.getElement(e);return t?(r&&(null==this.originalCursor&&(this.originalCursor=t.style.cursor),t.style.cursor=r),t):void 0},getElement:function(e){var t=this.element;if(!t){if(t=aria.utils.Dom.getElementById(this.id),!t)return e===!0&&this.$logError(this.INVALID_ATTRIBUTE,["id","constructor"]),void 0;this.element=t}return t},_setElementStyle:function(e){var t=aria.utils.Dom.getOffset(e),i={left:t.left,top:t.top};this._elementInitialPosition=i;var r=e.style;r.position="absolute",r.left=i.left+"px",r.top=i.top+"px"},getMovable:function(e){var t=this.proxy;if(t)return t.overlay;var i=this.params,r=i.proxy;if(r){var s="aria.utils.overlay."+r.type;return Aria.load({classes:[s],oncomplete:e===!1?null:{fn:this._createProxy,scope:this,args:{classpath:s,cfg:r.cfg}},onerror:{fn:function(){this.$logError(this.INVALID_ATTRIBUTE,["proxy","params"])},scope:this,override:!0}}),e===!1||this.proxy||(this.proxy={}),this.proxy?this.proxy.overlay:this.proxy}return this.getElement()},_createProxy:function(e){var t=Aria.getClassRef(e.classpath);try{var r=e.cfg||{};r.id=this.id||"proxy_"+i,i++,this.proxy=new t(this.getElement(),r)}catch(s){this.$logError(this.INVALID_ATTRIBUTE,["proxy","params"])}},start:function(e){this.posX=e.x,this.posY=e.y;var t,i=this.getElement(!0),r=aria.utils.Dom;i.onselectstart=Aria.returnFalse,this._setElementStyle(i),this._setBoundary();var s=this.getMovable();if(s){s.onselectstart=Aria.returnFalse,s.offsetTop<i.offsetTop&&(s.style.top=i.offsetTop+"px"),this._movableInitialGeometry=aria.utils.Dom.getGeometry(s),this._movableGeometry=aria.utils.Json.copy(this._movableInitialGeometry),t=r._getDocumentScroll().scrollTop,this._movableGeometry.y+=t>0?t:0;var a=aria.utils.Dom.getOffset(s);this._baseMovableOffset={left:this._movableGeometry.x-a.left,top:this._movableGeometry.y-a.top},this.$raiseEvent("dragstart")}},move:function(e){var t=this.getMovable(),i=aria.utils.Dom;if(t&&t.style){var r=this._vertical?0:e.clientX-this.posX,s=this._horizontal?0:e.clientY-this.posY,a=aria.utils.Json.copy(this._movableGeometry);a.x+=r,a.y+=s;var n=this._boundary?i.fitInside(a,this._boundary):{top:a.y,left:a.x};t.style.top=n.top-this._baseMovableOffset.top+"px",t.style.left=n.left-this._baseMovableOffset.left+"px",a.y=n.top,a.x=n.left,this.posY+=a.y-this._movableGeometry.y,this.posX+=a.x-this._movableGeometry.x,this._movableGeometry=a,this.$raiseEvent("move")}},end:function(){var e,t=this.getElement(),i=aria.utils.Dom;e=i._getDocumentScroll().scrollTop,t.onselectstart=Aria.returnTrue,this.proxy&&this.proxy.overlay&&(this._movableInitialGeometry.y+=e>0?e:0,t.style.top=this._elementInitialPosition.top+this._movableGeometry.y-this._movableInitialGeometry.y+"px",t.style.left=this._elementInitialPosition.left+this._movableGeometry.x-this._movableInitialGeometry.x+"px",this.proxy.$dispose(),this.proxy=null),this.$raiseEvent("dragend")},_setBoundary:function(){var e=this.params.constrainTo,t=aria.utils.Dom;return e&&e!==t.VIEWPORT?(aria.utils.Type.isString(e)&&(e=t.getElementById(e)),e?(this._boundary=aria.utils.Dom.getGeometry(e),void 0):(this._boundary=null,this.$logError(this.INVALID_ATTRIBUTE,["constrainTo","params"]),void 0)):(this._boundary=e,void 0)}}})})();
//*******************
//LOGICAL-PATH:aria/utils/dragdrop/DragDropBean.js
//*******************
Aria.beanDefinitions({$package:"aria.utils.dragdrop.DragDropBean",$namespaces:{json:"aria.core.JsonTypes"},$beans:{DragCfg:{$type:"json:Object",$properties:{handle:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:String"},{$type:"json:ObjectRef"}]},cursor:{$type:"json:String"},proxy:{$type:"ProxyCfg"},constrainTo:{$type:"json:MultiTypes",$contentTypes:[{$type:"json:String"},{$type:"json:String"},{$type:"json:ObjectRef"}]},axis:{$type:"json:Enum",$enumValues:["x","y"]}}},ProxyCfg:{$type:"json:Object",$properties:{type:{$type:"json:Enum",$enumValues:["Overlay","CloneOverlay"]},cfg:{$type:"json:ObjectRef"}}}}});
//*******************
//LOGICAL-PATH:aria/utils/resize/Resize.js
//*******************
Aria.classDefinition({$classpath:"aria.utils.resize.Resize",$extends:"aria.utils.dragdrop.Drag",$dependencies:["aria.utils.Dom","aria.utils.String","aria.utils.Json"],$constructor:function(e,t){t=t||{};var i={type:"Overlay"},r=e,s=this;this.minHeight=100,this.minWidth=100,this.$Drag.constructor.call(s,r,{handle:t.handle,cursor:t.cursor,proxy:i,axis:t.axis,constrainTo:aria.utils.Dom.VIEWPORT})},$destructor:function(){this.$Drag.$destructor.call(this),this.minHeight=null,this.minWidth=null},$prototype:{start:function(e){this.posX=e.x,this.posY=e.y;var t,i=this.getElement(!0),r=Aria.$window.document;i.onselectstart=Aria.returnFalse,r.onselectstart=Aria.returnFalse,this._setElementStyle(i),this._setBoundary(),t=this.getMovable(),t&&(t.onselectstart=Aria.returnFalse,this._movableInitialGeometry=aria.utils.Dom.getGeometry(t),this._movableGeometry=aria.utils.Json.copy(this._movableInitialGeometry),this._baseMovableOffset={left:this._movableGeometry.x-t.offsetLeft,top:this._movableGeometry.y-t.offsetTop,height:this._movableGeometry.height-t.offsetHeight,width:this._movableGeometry.width-t.offsetWidth},this.$raiseEvent("beforeresize"))},move:function(e){var t=this.getMovable();if(t&&t.style){var i,r,s=this._vertical?0:e.clientX-this.posX,a=this._horizontal?0:e.clientY-this.posY,n=aria.utils.Json.copy(this._movableGeometry);n=this._resizeWitHandlers(n,this.cursor,s,a);var o=/sw-resize|nw-resize|w-resize/.test(this.cursor),l=/nw-resize|ne-resize|n-resize/.test(this.cursor),c=n.width<this.minWidth,h=n.height<this.minHeight;c&&(n.width=this.minWidth),h&&(n.height=this.minHeight),i=this._movableGeometry.x+this._movableGeometry.width,r=this._movableGeometry.y+this._movableGeometry.height,c&&o&&(n.x=i-this.minWidth),h&&l&&(n.y=r-this.minHeight),t.style.cursor=this.cursor,t.style.top=n.y-this._baseMovableOffset.top+"px",t.style.left=n.x-this._baseMovableOffset.left+"px",t.style.height=n.height-this._baseMovableOffset.height+"px",t.style.width=n.width-this._baseMovableOffset.width+"px",this._movableGeometry=n,this.$raiseEvent("resize")}},end:function(){var e=this.getElement();e.onselectstart=Aria.returnTrue,this.proxy&&this.proxy.overlay&&(e.style.top=this._elementInitialPosition.top+this._movableGeometry.y-this._movableInitialGeometry.y+"px",e.style.left=this._elementInitialPosition.left+this._movableGeometry.x-this._movableInitialGeometry.x+"px",e.style.height=this._elementInitialPosition.height+this._movableGeometry.height-this._movableInitialGeometry.height+"px",e.style.width=this._elementInitialPosition.width+this._movableGeometry.width-this._movableInitialGeometry.width+"px",this.proxy.$dispose(),this.proxy=null),this.$raiseEvent("resizeend")},_resizeWitHandlers:function(e,t,i,r){var e=aria.utils.Json.copy(e),s=aria.utils.String.trim;t=s(t);var a=e.width>=this.minWidth?i:0,n=e.height>=this.minHeight?r:0;switch(t){case"n-resize":e.y+=n,e.height-=n,e=this._fitResizeBoundary(e),this.posY+=e.y-this._movableGeometry.y;break;case"ne-resize":e.y+=n,e.height-=n,e.width+=a,e=this._fitResizeBoundary(e),this.posX+=a,this.posY+=e.y-this._movableGeometry.y;break;case"nw-resize":e.x+=a,e.y+=n,e.height-=n,e.width-=a,e=this._fitResizeBoundary(e),this.posX+=e.x-this._movableGeometry.x,this.posY+=e.y-this._movableGeometry.y;break;case"s-resize":e.height+=n,e=this._fitResizeBoundary(e),this.posY+=n;break;case"se-resize":e.height+=n,e.width+=a,e=this._fitResizeBoundary(e),this.posY+=n,this.posX+=a;break;case"sw-resize":e.x+=a,e.height+=n,e.width-=a,e=this._fitResizeBoundary(e),this.posY+=n,this.posX+=e.x-this._movableGeometry.x;break;case"e-resize":e.width+=a,e=this._fitResizeBoundary(e),this.posX+=a;break;case"w-resize":e.x+=a,e.width-=a,e=this._fitResizeBoundary(e),this.posX+=e.x-this._movableGeometry.x}return e},_fitResizeBoundary:function(e){var t=aria.utils.Dom,i=this._boundary?t.fitInside(e,this._boundary):{top:e.y,left:e.x};return e.x=i.left,e.y=i.top,e},_setElementStyle:function(e){var t=e.style,i={left:e.offsetLeft,top:e.offsetTop,height:e.offsetHeight,width:e.offsetWidth};this._elementInitialPosition=i,t.position="absolute",t.left=i.left+"px",t.top=i.top+"px",t.height=i.height+"px",t.width=i.width+"px"}}});